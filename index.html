<!doctype html>
<html>
<head>


<style>
        #containerDiv{
            position: relative;
        }

        body{
            background-color: #2f2f2f;
        }

        #overText{
            color: white;
        }

        #opprettMedlemDiv{
            position: absolute;
            width: 300px;

        }

        #medlemsForm{
            display: grid;
            grid-row-gap: 10px;

        }

        #rMedlemBtn{
            width: 100px;
        }

        #opprettOppgaveDiv{
            position: absolute;
            width: 300px;
            left: 350px;

        }

        #oppgaveForm{
            display: grid;
            grid-row-gap: 10px;
        }

        #listeDiv{
            position: absolute;
            top: 200px;
        }

        #teamMembers{
            background-color: white;
        }

        #oppgaveDiv{
            position: absolute;
            left: 350px;
            top: 200px;
        }

        #oppGaver{
            background-color: white;
        }
        


</style>

</head>

<body>

    <h1 id="overText">Arbeidstildeling</h1>
    

    <div id="containerDiv">
       

    <div id="opprettMedlemDiv">
    
        <h3 id="overText">Registrer nytt teammedlem</h3>
        <form id="medlemsForm" onsubmit="registerMember(event)">
        <input name="name" id="nameInput" class="medlemInputs" placeholder="Navn..">
        <input name="employeeId" class="medlemInputs" placeholder="Ansattnummer..">
        <input type="submit" id="rMedlemBtn" value="Registrer"/>
        </form>

    </div>

    <div id="opprettOppgaveDiv">
        <h3 id="overText">Registrer ny arbeidsoppgave</h3>
        <form id="oppgaveForm" onsubmit="registerTask(event)">
        <input name="headLine" id="overskriftInput" class="oppgaveInputs" placeholder="Overskrift..">
        <textArea name="description" class="oppgaveInputsInputs" placeholder="Hva skal gjøres?"></textArea>
        <select name="Navn" id="delegateTask"></select>
        <input type="submit" value="Registrer"/>
        </form>
    </div>


    <div id="listeDiv">
        
        <form id="visMedlem" onsubmit="displayMembers(event)">
        <input type="submit" value="Vis teamMedlemmer"/>
        </form>
        <div id="teamMembers"></div>




    </div>
        <div id="oppgaveDiv">

            <form id="visOppgave" onsubmit="displayOppgaver(event)">
                <input type="submit" value="Vis oppgaver"/>
            </form>
            <div id="oppGaver"></div>

        </div>

    </div>

</body>

<script>


// REGISTRERE MEDLEM
    

     function registerMember(event){
        event.preventDefault();

        let name = document.querySelector("[name='name']").value;
        let employeeId = document.querySelector("[name='employeeId']").value;

        if((name === "") || (employeeId === "")){
            window.alert("Fyll inn boksene for å registrere et medlem");
        } else {

        const medlemListe = JSON.parse(window.localStorage.getItem("teamList")) || [];

        medlemListe.push({name: name, ansattnr: employeeId});


        window.localStorage.setItem("teamList", JSON.stringify(medlemListe));


        event.target.reset();
        }

     }

// REGISTRERE NY ARBEIDSOPPGAVE

    function registerTask(event) {
        event.preventDefault();

        const headLine = document.querySelector("[name='headLine']").value;
        const description = document.querySelector("[name='description']").value;
        const assignedMember = document.getElementById("delegateTask").value;

        if(headLine === ""){
            window.alert("Fyll inn overskrift for å registrere en oppgave");
        } else if(description === ""){
            window.alert("Fyll inn en beskrivelse av hva som skal gjøres for å registrere en oppgave");
        } else {

        const assignmentList = JSON.parse(window.localStorage.getItem("assignmentList")) || [];

        assignmentList.push({headLine: headLine, description: description, member: assignedMember});
        window.localStorage.setItem("assignmentList", JSON.stringify(assignmentList));

        event.target.reset();
        }

    }

    
// VIS MEDLEMMER

    function displayMembers(event) {
        event.preventDefault();

        let outputDiv = document.getElementById("teamMembers");
        outputDiv.innerHTML = "";

        let teamInputs = JSON.parse(localStorage.getItem("teamList"));
        

        if(teamInputs === null){
            let emptyMessage = document.createElement("div");
            emptyMessage.innerHTML = "Legg til medlemmer for at de skal vises";
            outputDiv.appendChild(emptyMessage);
        } else {
            for(let i=0; i<teamInputs.length; i++){
                let members = document.createElement("div");
                members.innerHTML = teamInputs[i].name + ": " + teamInputs[i].ansattnr;
                outputDiv.appendChild(members);

            }
        }
    }


// Vis mulige medlemmer i drop-down liste

    const taskDown = document.getElementById("delegateTask");
    taskDown.value = "";
    taskDown.text = "Tildel til et medlem";
    let firstOption = document.createElement("option");
    firstOption.value = "Tildel oppgave til et medlem";
    firstOption.text = "Tildel oppgave til et medlem";
    taskDown.appendChild(firstOption);

    const dragMemberList = JSON.parse(window.localStorage.getItem("teamList")) || [];
    let nameArray = [];

    for(const participant of dragMemberList){
        nameArray.push(participant.name);
    }

    if(nameArray === []){
        let newOption = document.createElement("option");
        newOption.value="Medlemslisten er tom";
        newOption.text = "Listen er tom";
        taskDown.appendChild(newOption);
    }else {
        for(let i=0; i<nameArray.length; i++){
            let option = document.createElement("option");
            option.value = nameArray[i];
            option.text = nameArray[i];
            taskDown.appendChild(option);
        }

    }


// VIS OPPGAVER OG TILDELINGEN TIL TEAMMEDLEMMER

  function displayOppgaver(event) {
        event.preventDefault();

        let oppgaveOutputDiv = document.getElementById("oppGaver");
        oppgaveOutputDiv.innerHTML = "";

        let oppGaveInputs = JSON.parse(window.localStorage.getItem("assignmentList"));
        let memberOutputs = JSON.parse(window.localStorage.getItem("teamList"));

        

  if(oppGaveInputs === null){

            let emptyMessage = document.createElement("div");
            emptyMessage.innerHTML = "Legg til oppgaver for at de skal vises";
            oppgaveOutputDiv.appendChild(emptyMessage);
        
        } else {
            
            let arrayLength = oppGaveInputs.length;
                
                for(let i=0; i<arrayLength; i++){
                let oppgaver = document.createElement("div");
       
                oppgaver.innerHTML = `* ${oppGaveInputs[i].headLine}:
                ${oppGaveInputs[i].description}
                Gjøres av: ${oppGaveInputs[i].member}`;
       
                oppgaveOutputDiv.appendChild(oppgaver);
                }
        } 
  }


</script>


</html>