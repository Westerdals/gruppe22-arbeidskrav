<!doctype html>
<html>
<head>


<style>
        #containerDiv{
            position: relative;
        }

        body{
            background-color: #2f2f2f;
        }

        #overText{
            color: white;
        }

        #opprettMedlemDiv{
            position: absolute;
            width: 300px;

        }

        #medlemsForm{
            display: grid;
            grid-row-gap: 10px;

        }

        #rMedlemBtn{
            width: 100px;
        }

        #opprettOppgaveDiv{
            position: absolute;
            width: 300px;
            left: 350px;

        }

        #oppgaveForm{
            display: grid;
            grid-row-gap: 10px;
        }

        #listeDiv{
            position: absolute;
            top: 200px;
        }

        #teamMembers{
            background-color: white;
        }
        


</style>

</head>

<body>

    <h1 id="overText">Arbeidstildeling</h1>
    

    <div id="containerDiv">
       

    <div id="opprettMedlemDiv">
    
        <h3 id="overText">Registrer nytt teammedlem</h3>
        <form id="medlemsForm" onsubmit="registerMember(event)">
        <input name="name" id="nameInput" class="medlemInputs" placeholder="Navn..">
        <input name="employeeId" class="medlemInputs" placeholder="Ansattnummer..">
        <input type="submit" id="rMedlemBtn" value="Registrer"/>
        </form>

    </div>

    <div id="opprettOppgaveDiv">
        <h3 id="overText">Registrer ny arbeidsoppgave</h3>
        <form id="oppgaveForm" onsubmit="registerTask">
        <input name="headLine" id="overskriftInput" class="oppgaveInputs" placeholder="Overskrift..">
        <textArea name="description" class="oppgaveInputsInputs" placeholder="Hva skal gjÃ¸res?"></textArea>
        <select name="Navn" id="delegateTask"></select>
        <input type="submit" value="Registrer"/>
        </form>
    </div>


    <div id="listeDiv">
        
        <form id="visMedlem" onsubmit="displayMembers(event)">
        <input type="submit" value="Vis teamMedlemmer"/>
        </form>
        <div id="teamMembers"></div>




    </div>








    </div>

</body>

<script>

        // REGISTRERE NY ARBEIDSOPPGAVE

        function registerTask(event) {
        event.preventDefault();

        const headLine = document.querySelector("[name='headLine']").value;
        const description = document.querySelector("[name='description']").value;
        const assignedMember = document.getElementById("delegateTask").value;

        const assignmentList = JSON.parse(window.localStorage.getItem("assignmentList")) || [];

        assignmentList.push({headLine: headLine, description: description, member: assignedMember});
        window.localStorage.setItem("assignmentList", JSON.stringify(assignmentList));

        event.target.reset();

    }

    /* function getItemFromStorage(title) {
        const getem = JSON.parse(window.localStorage.getItem(`"${title}"`));
        return getem;
    }

    baz = new getItemFromStorage(teamListe);
    console.log(baz);

    */

    // OPPDATER MEDLEMSLISTE
        
        let some;


    // REGISTERE NYTT MEDLEM

    /* 
var a = [];
a.push(JSON.parse(localStorage.getItem('session')));
localStorage.setItem('session', JSON.stringify(a));

function SaveDataToLocalStorage(data)
{
    var a = [];
    // Parse the serialized data back into an aray of objects
    a = JSON.parse(localStorage.getItem('session')) || [];
    // Push the new data (whether it be an object or anything else) onto the array
    a.push(data);
    // Alert the array value
    alert(a);  // Should be something like [Object array]
    // Re-serialize the array back into a string and store it in localStorage
    localStorage.setItem('session', JSON.stringify(a));


    */

    /* (function openStorage()){
        let teamList = [];
        teamList.push(localStorage.setItem)
    })();
    
    function registerMember(event){
        event.preventDefault();

        const name = document.querySelector("[name='name']").value;
        const employeeId = document.querySelector("[name='employeeId']").value;

        const employee = {name, employeeId};

        let teamList = [];



        localStorage.setItem('teamList', JSON.stringify(teamList));
        teamList.push(employee);

        event.target.reset();
    } */

    // REGISTRERE MEDLEM
    

     function registerMember(event){
        event.preventDefault();

        const name = document.querySelector("[name='name']").value;
        const employeeId = document.querySelector("[name='employeeId']").value;


    
        // const employee = {name, employeeId};

        

        const medlemListe = JSON.parse(window.localStorage.getItem("teamList")) || [];

        medlemListe.push({name: name, ansattnr: employeeId});


        window.localStorage.setItem("teamList", JSON.stringify(medlemListe));


        event.target.reset();

     }




// VIS MEDLEMMER

    function displayMembers(event) {
        event.preventDefault();

        let outputDiv = document.getElementById("teamMembers");
        outputDiv.innerHTML = "";

        let teamInputs = JSON.parse(localStorage.getItem("teamList"));


        if(teamInputs === null){
            let emptyMessage = document.createElement("div");
            emptyMessage.innerHTML = "Legg til medlemmer for at de skal vises";
            outputDiv.appendChild(emptyMessage);
        } else {
            for(let i=0; i<teamInputs.length; i++){
                let members = document.createElement("div");
                members.innerHTML = teamInputs[i].name + ": " + teamInputs[i].ansattnr;
                outputDiv.appendChild(members);

            }
        }
       /*  let optionOutput = document.createElement("option");
            optionOutput.value = teamInputs[i].name;
            optionOutput.value = teamInputs[i].name; 
*/

        event.target.reset();
    }


// ARBEIDSOPPGAVE

    const taskDown = document.getElementById("delegateTask");
    taskDown.value = "";
    taskDown.text = "";

    const dragMemberList = JSON.parse(window.localStorage.getItem("teamList")) || [];
    let nameArray = [];

    for(const participant of dragMemberList){
        nameArray.push(participant.name);
    }

    if(nameArray === []){
        let newOption = document.createElement("option");
        newOption.value="Medlemslisten er tom";
        newOption.text = "Listen er tom";
        taskDown.appendChild(newOption);
    }else {
        for(let i=0; i<nameArray.length; i++){
            let option = document.createElement("option");
            option.value = nameArray[i];
            option.text = nameArray[i];
            taskDown.appendChild(option);
        }

    }
    




// REGISTRERE NY ARBEIDSOPPGAVE

    function registerTask(event) {
        event.preventDefault();

        const headLine = document.querySelector("[name='headLine']").value;
        const description = document.querySelector("[name='description']").value;
        const assignedMember = document.getElementById("delegateTask").value;

        const assignment = {headLine, description, assignedMember};
        console.log(assignment);

        const assignmentList = [assignment];
        window.localStorage.setItem("assignmentList", JSON.stringify([assignmentList]));

        event.target.reset();

    }




    
     window.addEventListener("storage", function event(){
        if(event.key === "teamListe"){
            displayMembers();
        }
    });




</script>


</html>